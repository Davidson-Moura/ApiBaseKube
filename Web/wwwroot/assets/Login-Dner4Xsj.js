import{a1 as h,bh as c,c as t,a3 as a,V as f,aj as g,d,a7 as w,bo as V,bg as v,S as y,a5 as b,a6 as $,bp as M,a8 as R}from"./index-CDg5AEKA.js";import{V as L,a as _}from"./VRow-CNtGEtfc.js";import{V as u,a as C,b as q,c as I}from"./VCard-DbBhv8XL.js";import{V as A}from"./VForm-CBz1L2Tl.js";import{d as p}from"./VTextField-BQLWiT8M.js";const P="/imgs/LoginImage.png",T={data(){return{valid:!1,inRequest:!1,apps:[],email:"",password:"",appId:"",viewPassword:!1,emailRules:[e=>!!e||this.$t("message.EmailIsRequired"),e=>!e.includes("@")||/.+@.+\..+/.test(e)||this.$t("message.EmailInvalid")],passwordRules:[e=>!!e||this.$t("message.PasswordIsRequired"),e=>e&&e.length>=6||this.$t("message.PasswordDoesNotHaveTheMinimumNumberOfCharacters")],appIdRules:[e=>!!e||this.$t("message.TheFieldIsRequired")]}},mounted(){this.onLogout()},methods:{login(){if(this.valid){if(this.inRequest)return;this.inRequest=!0,this.$MyApp.setLoading(!0);let e={AppId:this.appId,Login:this.email,Password:this.password};this.$axios.post(this.$api.login,e,{withCredentials:!0}).then(s=>{this.inRequest=!1,this.$axios.prototype.Token=s.data.Token,this.$store.commit("sessionModule/setSessionManager",s.data),this.$MyApp.setLoading(!1),this.$MyApp.success(this.$t("message.LoginSuccess")),Promise.all([this.$MyApp.loadMainMenus(!0),this.$MyApp.loadPermissions(!0)]).then(o=>{this.afterLogin()})}).catch(s=>{this.inRequest=!1,this.$MyApp.setLoading(!1)})}},afterLogin(){var o,r;this.inRequest=!1;let e=(o=this.$route.params)==null?void 0:o.redirectUrl,s=(r=this.$route.params)==null?void 0:r.id;e&&s?this.$router.push({name:e,params:{id:s}}):this.$router.push({name:"Home"})},navTo(e){this.$router.push({name:e})},onLogout(){this.$MyApp.isLogged()&&(this.$MyApp.logout(),this.removeCookies(),this.$MyApp.success(this.$t("message.LogoutSuccess")))},removeCookies(){document.cookie.split(";").forEach(e=>{const s=e.indexOf("="),o=s>-1?e.substr(0,s):e;document.cookie=o.trim()+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/"})}}},x={class:"d-inline"},k={class:"d-flex"};function S(e,s,o,r,i,n){const m=M("t");return R(),c("div",null,[t(_,{fluid:"",class:"fill-height"},{default:a(()=>[t(L,{justify:"center",align:"center",class:"fill-height"},{default:a(()=>[t(u,{cols:"12",sm:"8",md:"4"},{default:a(()=>[t(f,{src:P})]),_:1}),t(u,{cols:"12",sm:"8",md:"4"},{default:a(()=>[t(C,{class:"elevation-12 pa-5"},{default:a(()=>[t(q,{class:"d-flex align-center justify-center"},{default:a(()=>[g(d("h3",x,null,512),[[m,"label.loginWelcome"]]),t(w,{icon:"mdi-plus",color:"#A5C749"})]),_:1}),t(I,null,{default:a(()=>[t(A,{ref:"form",modelValue:i.valid,"onUpdate:modelValue":s[3]||(s[3]=l=>i.valid=l),onSubmit:V(n.login,["prevent"])},{default:a(()=>[t(p,{modelValue:i.email,"onUpdate:modelValue":s[0]||(s[0]=l=>i.email=l),label:e.$t("label.email"),type:"email","prepend-inner-icon":"mdi-email-outline",variant:"outlined",required:"",rules:i.emailRules},null,8,["modelValue","label","rules"]),t(p,{class:"mt-2",modelValue:i.password,"onUpdate:modelValue":s[1]||(s[1]=l=>i.password=l),label:e.$t("label.password"),required:"",rules:i.passwordRules,"prepend-inner-icon":"mdi-lock-outline",variant:"outlined","hide-details":"auto","append-inner-icon":i.viewPassword?"mdi-eye":"mdi-eye-off","onClick:appendInner":s[2]||(s[2]=l=>i.viewPassword=!i.viewPassword),type:i.viewPassword?"":"password",onKeyup:v(n.login,["enter"])},null,8,["modelValue","label","rules","append-inner-icon","type","onKeyup"]),d("div",k,[t(y,{disabled:!i.valid,color:"success",rounded:"",class:"mt-4",style:{"margin-left":"auto"},type:"submit","append-icon":"mdi-login"},{default:a(()=>[b($(e.$t("label.toLogin")),1)]),_:1},8,["disabled"])])]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}const j=h(T,[["render",S]]);export{j as default};
